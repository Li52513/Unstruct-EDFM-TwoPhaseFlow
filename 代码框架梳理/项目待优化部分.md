# 项目待优化部分

## 一、基岩网格数据结构部分

1. 潜在坑点/前置条件/默认假设（仅记录，不展开重构方案）：
   1. **Face 的 AABB 仅在 2D 情况构建**：`Face::computeGeometry()` 里只有 `n==2`（线段）分支计算 `boundingBox`；`n==3`（三角面片）分支未赋值 `boundingBox`。但 `buildFaceBins()` 与 `getCandidateFacesFromBins()` 依赖 `f.boundingBox` 统计范围与分桶，因此 **3D 下分桶逻辑不可靠/可能失效**（本次上传内容可直接定位该事实）。
   2. `Mesh::exportToTxt()` 的 face 输出只写前两个节点 `n1 n2`，对 3D 面不完整。
   3. `BuildMesh()` 中 3D 扫掠的 `recombine` 参数被固定写死为 `true`，同时存在未使用的局部变量 `recombineForHex`（定义了但没传进去）。这会影响三角底/四边形底最终单元类型（注释里解释了差异）。
   4. `getCandidateFacesFromBins()` 内部重新扫描 `faces_` 计算 `minX/minY`，而 `buildFaceBins()` 也扫描一遍。两者逻辑一致但 **没有把 minX/minY 缓存为成员**，因此对性能与一致性都存在隐含假设（尤其是未来若 boundingBox 构建策略变化）。
   5. `Variable3D::Normalize()` 的零判断逻辑看起来“反着写”：
      - 代码是 `if (GeneralMethods::isZero(mag)) { m_x/=mag; ... } else { print too small; exit; }`
      - 这意味着当 `mag≈0` 时反而会除以 0；当 `mag` 不小却报“too small”。
      - 由于 `GeneralMethods::isZero` 未在本次上传中给出，实现无法确认，但就当前函数体逻辑而言存在明显风险。